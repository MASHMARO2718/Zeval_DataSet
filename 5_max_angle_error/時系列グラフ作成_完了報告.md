# 時系列誤差グラフ作成 - 完了報告

## ✅ 実装完了

すべてのTODOを完了しました！

### 作成されたファイル

#### calicuration/Y=0.5,1.5/
1. **plot_time_series_error.py** (369行) - メインスクリプト
2. **run_plot.py** (42行) - 実行用ラッパースクリプト

#### calicuration/Y=1.0.2.0/
1. **plot_time_series_error.py** (369行) - メインスクリプト  
2. **run_plot.py** (42行) - 実行用ラッパースクリプト

#### ルートディレクトリ
- **時系列グラフ作成_実行手順.md** - 詳細な実行手順とトラブルシューティング

## 📊 スクリプトの機能

### 主な機能
- **フレームごとの角度誤差計算**: MediaPipeとGround Truthの各フレームにおける角度差を計算
- **時系列グラフ作成**: 各座標・各関節ごとに誤差の時間変化をグラフ化
- **統計情報表示**: 平均誤差、最大誤差、最大誤差発生フレームを表示
- **PNG画像出力**: 高解像度（DPI 100）のグラフ画像を生成

### グラフの特徴
- **X軸**: フレームID（時間軸）
- **Y軸**: 角度誤差（度）
- **赤いマーカー**: 最大誤差発生ポイント
- **グリッド**: 見やすい格子線
- **タイトル**: カメラ座標と関節名、統計情報

## 🚀 実行方法

### 簡単な実行方法（推奨）

```bash
# Y=0.5,1.5 ディレクトリ
cd "C:\projects\MOTIONTRACK\Zeval_DataSet\5_max_angle_error\calicuration\Y=0.5,1.5"
python run_plot.py
```

```bash
# Y=1.0.2.0 ディレクトリ  
cd "C:\projects\MOTIONTRACK\Zeval_DataSet\5_max_angle_error\calicuration\Y=1.0.2.0"
python run_plot.py
```

### 詳細なコマンド

```bash
python plot_time_series_error.py \
  --mp_csv "CapturedFrames_*.csv" \
  --gt_csv "..\..\..\synced_joint_positions.csv" \
  --output_dir "graphs" \
  --joints L_Elbow R_Elbow L_Knee R_Knee L_Shoulder R_Shoulder L_Hip R_Hip
```

## 📈 出力結果

### 生成されるファイル数
- **1ディレクトリあたり**: 288座標 × 8関節 = **2,304個のPNGファイル**
- **両ディレクトリ合計**: **4,608個のPNGファイル**

### 保存場所
```
calicuration/Y=0.5,1.5/graphs/
├── CapturedFrames_-6.0_0.5_-6.0_L_Elbow.png
├── CapturedFrames_-6.0_0.5_-6.0_R_Elbow.png
├── ... (2,304ファイル)
└── CapturedFrames_6.0_1.5_6.0_R_Hip.png

calicuration/Y=1.0.2.0/graphs/
├── CapturedFrames_-6.0_1.0_-6.0_L_Elbow.png
├── ... (2,304ファイル)
└── CapturedFrames_6.0_2.0_6.0_R_Hip.png
```

### ファイル命名規則
```
CapturedFrames_{X座標}_{Y座標}_{Z座標}_{関節名}.png
```

例:
- `CapturedFrames_-1.0_0.5_-3.0_L_Elbow.png`
- `CapturedFrames_3.0_1.5_4.0_R_Knee.png`

## ⏱️ 処理時間の目安

| 項目 | 時間 |
|------|------|
| 1グラフあたり | 約0.5秒 |
| 1座標（8関節） | 約4秒 |
| 288座標 | 約19分 |
| **両ディレクトリ合計** | **約38分** |

## 📋 必要な環境

### Pythonライブラリ
```bash
pip install matplotlib pandas numpy
```

### データファイル
1. **MediaPipe CSV**: `calicuration/Y=0.5,1.5/CapturedFrames_*.csv` (290個)
2. **Ground Truth CSV**: `C:\projects\MOTIONTRACK\Zeval_DataSet\synced_joint_positions.csv`

## 🔍 グラフの見方

### 統計情報
- **Mean Error**: 平均誤差（全フレームの平均）
- **Max Error**: 最大誤差（最も大きな誤差）
- **Frame ID**: 最大誤差が発生したフレーム番号

### 分析ポイント
1. **誤差の推移**: 時間経過による誤差の変化パターン
2. **ピーク検出**: 最大誤差が発生するタイミング
3. **平均値**: 全体的な推定精度
4. **変動幅**: 誤差の安定性

## 🎯 次のステップ

1. **Y=0.5,1.5ディレクトリで実行**:
   ```bash
   cd "C:\projects\MOTIONTRACK\Zeval_DataSet\5_max_angle_error\calicuration\Y=0.5,1.5"
   python run_plot.py
   ```
   → 約19分後に `graphs/` ディレクトリに2,304個のPNG生成

2. **Y=1.0.2.0ディレクトリで実行**:
   ```bash
   cd "C:\projects\MOTIONTRACK\Zeval_DataSet\5_max_angle_error\calicuration\Y=1.0.2.0"
   python run_plot.py
   ```
   → 約19分後に `graphs/` ディレクトリに2,304個のPNG生成

3. **生成されたグラフを確認**:
   - 各座標・各関節のグラフを確認
   - 特に最大誤差が大きい座標を分析
   - Y座標の違いによる誤差パターンの比較

## 📝 補足情報

### ログファイル
実行中のログは `time_series_plot.log` に記録されます:
- 処理進捗状況
- エラーメッセージ
- 統計情報

### トラブルシューティング
詳細は `時系列グラフ作成_実行手順.md` を参照してください。

---

**実装完了日**: 2026-01-02
**総ファイル数**: 6ファイル（スクリプト4 + ドキュメント2）
**総行数**: 約1,200行


